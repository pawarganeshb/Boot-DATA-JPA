package com.ganesh.app.runner;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;

import com.ganesh.app.entity.Profile;
import com.ganesh.app.entity.User;
import com.ganesh.app.service.IUserService;

@Component
public class MyRunner implements CommandLineRunner {
	@Autowired
	private IUserService userService;

	@Override
	public void run(String... args) throws Exception {
		try {
	        // Create Profile
	        Profile profile = new Profile();
	        profile.setName("John Doe");

	        // Create User and link the Profile
	        User user = new User();
	        user.setBio("Aspiring Developer");
	        user.setProfile(profile); // Link profile to user

	        // Link User to Profile (this step ensures bidirectional consistency)
	        profile.setUser(user);

	        // Save the User (Profile will also be saved due to CascadeType.ALL)
	        String saveUser = userService.saveUser(user);
	        System.out.println(saveUser);
	    } catch (Exception e) {
	        e.printStackTrace();
	    }
	}
}
